"use strict";var f=Object.create;var r=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var v=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var I=(e,t)=>{for(var o in t)r(e,o,{get:t[o],enumerable:!0})},l=(e,t,o,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of u(t))!y.call(e,s)&&s!==o&&r(e,s,{get:()=>t[s],enumerable:!(a=h(t,s))||a.enumerable});return e};var p=(e,t,o)=>(o=e!=null?f(v(e)):{},l(t||!e||!e.__esModule?r(o,"default",{value:e,enumerable:!0}):o,e)),w=e=>l(r({},"__esModule",{value:!0}),e);var R={};I(R,{main:()=>A});module.exports=w(R);var i=p(require("axios")),m=p(require("archiver")),g=`Bearer ${process.env.TOKEN}`,x=process.env.ACCOUNT_ID,z=async()=>(await i.default.get(`https://api.cloudflare.com/client/v4/accounts/${x}/images/v2`,{headers:{Authorization:g}})).data,b=async(e,t,o)=>{let a=`https://imagedelivery.net/DnKUqTjrmqfvonSskl9WBQ/${t}/raw`,s=await i.default.get(a,{headers:{Authorization:g},responseType:"arraybuffer"});e.append(Buffer.from(s.data),{name:o})},A=async e=>{let{result:t}=await z();console.log("Started Process..."),console.time("zip");let o=(0,m.default)("zip",{zlib:{level:9}});o.pipe(e),o.on("error",n=>{throw n});let a=t.images.length,s=100;for(let n=0;n<a;n+=s){let d=t.images.slice(n,n+s);console.log(`Index ${n+s} of ${a}`),await Promise.all(d.map(c=>b(o,c.id,c.filename)))}o.on("finish",()=>{console.log("Finish"),e.end()}),o.on("progress",({entries:n})=>console.log(n)),await o.finalize(),console.timeEnd("zip")};0&&(module.exports={main});
